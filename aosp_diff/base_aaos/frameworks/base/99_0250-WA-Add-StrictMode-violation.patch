From c7d2130500e8ef92cf54a0c7d3881d4bf30987ea Mon Sep 17 00:00:00 2001
From: "Alam, SahibeX" <sahibex.alam@intel.com>
Date: Fri, 23 Feb 2024 06:46:48 +0000
Subject: [PATCH] WA-Add StrictMode violation

Tracked-On: OAM-114158
Signed-off-by: svenate <salini.venate@intel.com>
---
 core/java/android/app/Activity.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/core/java/android/app/Activity.java b/core/java/android/app/Activity.java
index 750e3d6f6fed..c4710dc6e5c4 100644
--- a/core/java/android/app/Activity.java
+++ b/core/java/android/app/Activity.java
@@ -740,7 +740,7 @@ public class Activity extends ContextThemeWrapper
         Window.OnWindowDismissedCallback,
         AutofillManager.AutofillClient, ContentCaptureManager.ContentCaptureClient {
     private static final String TAG = "Activity";
-    private static final boolean DEBUG_LIFECYCLE = false;
+    private static final boolean DEBUG_LIFECYCLE = true;
 
     /** Standard activity result: operation canceled. */
     public static final int RESULT_CANCELED    = 0;
@@ -2385,6 +2385,7 @@ public class Activity extends ContextThemeWrapper
     protected void onPause() {
         if (DEBUG_LIFECYCLE) Slog.v(TAG, "onPause " + this);
         dispatchActivityPaused();
+	final StrictMode.VmPolicy oldPolicy = StrictMode.allowVmViolations();
         if (mAutoFillResetNeeded) {
             if (!mAutoFillIgnoreFirstResumePause) {
                 if (DEBUG_LIFECYCLE) Slog.v(TAG, "autofill notifyViewExited " + this);
@@ -2401,6 +2402,7 @@ public class Activity extends ContextThemeWrapper
 
         notifyContentCaptureManagerIfNeeded(CONTENT_CAPTURE_PAUSE);
         mCalled = true;
+	StrictMode.setVmPolicy(oldPolicy);
     }
 
     /**
-- 
2.17.1

